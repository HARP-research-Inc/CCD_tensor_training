{
  "training_completed_at": "2025-07-12T14:25:00.886399",
  "command_line_args": {
    "treebank": "en_gum",
    "combine": false,
    "penn_treebank": false,
    "combined_penn": false,
    "penn_path": null,
    "augment": false,
    "batch_size": 512,
    "adaptive_batch": false,
    "noise_threshold": 0.1,
    "min_batch_size": 512,
    "max_batch_adaptive": 2048,
    "pilot_batch_size": 1024,
    "small_batch_early": false,
    "variance_estimation_freq": 5,
    "model_dir": "test_timing",
    "model_prefix": null,
    "fixed_epochs": true,
    "max_epochs": 500,
    "patience": 15,
    "min_delta": 0.0001,
    "monitor": "macro_f1",
    "use_weighted_f1": false,
    "no_f1": false,
    "no_label_smoothing": false,
    "no_temp_scaling": false,
    "class_balanced": false,
    "class_balanced_temperature": 2.0,
    "class_balanced_scale": 0.5,
    "class_balanced_schedule": null,
    "class_balanced_threshold": 0.8,
    "class_balanced_warmup": 10,
    "adaptive_class_balanced": false,
    "adaptive_cb_threshold": 0.8,
    "adaptive_cb_min_samples": 10,
    "adaptive_cb_weight_power": 2.0,
    "adaptive_cb_max_ratio": 10.0,
    "adaptive_cb_update_freq": 5,
    "adaptive_cb_smoothing": 0.9,
    "cosine": false,
    "share": false,
    "gpu": null,
    "sgdr_t0": 10,
    "sgdr_t_mult": 2.0,
    "sgdr_eta_min": 1e-06,
    "compute_node": false,
    "detailed_analysis": false,
    "save_checkpoints": false,
    "checkpoint_freq": 10,
    "temp_calibration_freq": 25,
    "temp_calibration_samples": 1000,
    "dw_kernel": 3,
    "hash_embed": false,
    "hash_dim": 96,
    "num_buckets": 1048576,
    "ngram_min": 3,
    "ngram_max": 5,
    "f1_average": "macro"
  },
  "final_results": {
    "training_method": "fixed epochs",
    "total_epochs": 30,
    "final_train_acc": 0.9812723496811139,
    "final_val_acc": 0.8858692143825447,
    "final_val_ppl": 2.7162521157140946,
    "final_f1_score": 0.7453587977721104,
    "final_temperature": 0.9335698485374451,
    "final_batch_size": 512,
    "best_metric": 0.0,
    "perplexity": 2.7162521157140946,
    "accuracy": 0.8858692143825447,
    "f1_score": 0.7453587977721104,
    "timing": {
      "total_training_time_seconds": 27.837120294570923,
      "total_training_time_formatted": "27.8s",
      "average_epoch_time_seconds": 0.8764624277750651,
      "average_epoch_time_formatted": "0.9s",
      "epoch_times": [
        1.6555516719818115,
        0.86702561378479,
        0.8159663677215576,
        0.8731288909912109,
        0.8262729644775391,
        0.7850337028503418,
        0.7915167808532715,
        0.7847733497619629,
        0.7887217998504639,
        0.8268260955810547,
        0.8096797466278076,
        0.8073065280914307,
        0.8554103374481201,
        0.8427703380584717,
        0.8317148685455322,
        1.0936601161956787,
        0.8707239627838135,
        0.8219289779663086,
        0.892357349395752,
        0.8435404300689697,
        0.8486201763153076,
        0.7960846424102783,
        0.8629496097564697,
        0.8280441761016846,
        0.8430342674255371,
        0.7909348011016846,
        0.850348949432373,
        0.8191423416137695,
        0.8223962783813477,
        1.1484076976776123
      ]
    }
  },
  "training_history": [
    {
      "epoch": 1,
      "train_ppl": 19.71898382908651,
      "train_acc": 0.06205684652911756,
      "train_f1": 0.0,
      "val_ppl": 18.81463557933676,
      "val_acc": 0.06507004066877542,
      "val_f1": 0.0287389140487717,
      "lr": 0.008541719736702664
    },
    {
      "epoch": 2,
      "train_ppl": 25.093901105340585,
      "train_acc": 0.09154920923602491,
      "train_f1": 0.0,
      "val_ppl": 23.414656477475493,
      "val_acc": 0.10599703053385837,
      "val_f1": 0.01127511063959816,
      "lr": 0.04823403532281084
    },
    {
      "epoch": 3,
      "train_ppl": 18.01501229853291,
      "train_acc": 0.1601066640451233,
      "train_f1": 0.0,
      "val_ppl": 13.747116670166397,
      "val_acc": 0.1287199018785101,
      "val_f1": 0.013421147393679137,
      "lr": 0.010433294488066416
    },
    {
      "epoch": 4,
      "train_ppl": 13.534654082878536,
      "train_acc": 0.1668776189832508,
      "train_f1": 0.0,
      "val_ppl": 10.71313686722522,
      "val_acc": 0.3381318184752437,
      "val_f1": 0.12669442610030335,
      "lr": 0.06656670551193358
    },
    {
      "epoch": 5,
      "train_ppl": 9.116021322123853,
      "train_acc": 0.38144684616046304,
      "train_f1": 0.0,
      "val_ppl": 6.717899999306795,
      "val_acc": 0.4807953004970628,
      "val_f1": 0.20631177631419745,
      "lr": 0.05055452811950033
    },
    {
      "epoch": 6,
      "train_ppl": 6.392508900517704,
      "train_acc": 0.49840864126227313,
      "train_f1": 0.0,
      "val_ppl": 5.190618427119937,
      "val_acc": 0.5802724162416887,
      "val_f1": 0.3105473907705595,
      "lr": 0.028765964677189157
    },
    {
      "epoch": 7,
      "train_ppl": 5.289010217075727,
      "train_acc": 0.5690182729763938,
      "train_f1": 0.0,
      "val_ppl": 4.6515970779842535,
      "val_acc": 0.6274611064489058,
      "val_f1": 0.33873471219618734,
      "lr": 0.011641834822846097
    },
    {
      "epoch": 8,
      "train_ppl": 4.881874367905853,
      "train_acc": 0.6043353773179154,
      "train_f1": 0.0,
      "val_ppl": 4.253508611466924,
      "val_acc": 0.6896262345878252,
      "val_f1": 0.4146753094891832,
      "lr": 0.06990289601259354
    },
    {
      "epoch": 9,
      "train_ppl": 4.079263358994576,
      "train_acc": 0.7083451097976087,
      "train_f1": 0.0,
      "val_ppl": 3.5521444457314426,
      "val_acc": 0.7666386934348977,
      "val_f1": 0.49673673139924795,
      "lr": 0.06710650997549007
    },
    {
      "epoch": 10,
      "train_ppl": 3.3685283564273902,
      "train_acc": 0.8042935964707473,
      "train_f1": 0.0,
      "val_ppl": 3.185985314201525,
      "val_acc": 0.8297721257504357,
      "val_f1": 0.6142156067330552,
      "lr": 0.060773863607376244
    },
    {
      "epoch": 11,
      "train_ppl": 2.9426315395724014,
      "train_acc": 0.866129250279563,
      "train_f1": 0.0,
      "val_ppl": 2.9946539551611675,
      "val_acc": 0.8537860693305791,
      "val_f1": 0.666687864474448,
      "lr": 0.05168778173242899
    },
    {
      "epoch": 12,
      "train_ppl": 2.6922815368475894,
      "train_acc": 0.9021836636887572,
      "train_f1": 0.0,
      "val_ppl": 2.8851007352090137,
      "val_acc": 0.8654057194500032,
      "val_f1": 0.6911344084536851,
      "lr": 0.04097146151542712
    },
    {
      "epoch": 13,
      "train_ppl": 2.5329990166973944,
      "train_acc": 0.923737665433722,
      "train_f1": 0.0,
      "val_ppl": 2.7808289444972516,
      "val_acc": 0.8741850106513459,
      "val_f1": 0.7012843446798371,
      "lr": 0.029949625829250155
    },
    {
      "epoch": 14,
      "train_ppl": 2.448234476517296,
      "train_acc": 0.9331875099843936,
      "train_f1": 0.0,
      "val_ppl": 2.743717751351554,
      "val_acc": 0.8776063520753986,
      "val_f1": 0.7072899051640621,
      "lr": 0.019984764552787103
    },
    {
      "epoch": 15,
      "train_ppl": 2.394300613367784,
      "train_acc": 0.9405237352077368,
      "train_f1": 0.0,
      "val_ppl": 2.7437766468090756,
      "val_acc": 0.878316441804919,
      "val_f1": 0.7072067171471961,
      "lr": 0.012308707212469832
    },
    {
      "epoch": 16,
      "train_ppl": 2.3670325101346252,
      "train_acc": 0.944025953279182,
      "train_f1": 0.0,
      "val_ppl": 2.7219167929525105,
      "val_acc": 0.8796075140404106,
      "val_f1": 0.7104602632531057,
      "lr": 0.00787034750747319
    },
    {
      "epoch": 17,
      "train_ppl": 2.347333144701922,
      "train_acc": 0.9468154392518771,
      "train_f1": 0.0,
      "val_ppl": 2.7134046136494776,
      "val_acc": 0.8780582273578207,
      "val_f1": 0.7057085906661924,
      "lr": 0.06994536672081857
    },
    {
      "epoch": 18,
      "train_ppl": 2.2858111162491443,
      "train_acc": 0.9519028718188186,
      "train_f1": 0.0,
      "val_ppl": 2.6726934978114456,
      "val_acc": 0.8832870699115616,
      "val_f1": 0.7135618181902421,
      "lr": 0.06912965249252681
    },
    {
      "epoch": 19,
      "train_ppl": 2.2237705649543433,
      "train_acc": 0.960590830332895,
      "train_f1": 0.0,
      "val_ppl": 2.6632670650175516,
      "val_acc": 0.8847072493706023,
      "val_f1": 0.7154732078547484,
      "lr": 0.06735992064918979
    },
    {
      "epoch": 20,
      "train_ppl": 2.1846123954576235,
      "train_acc": 0.9655799550241468,
      "train_f1": 0.0,
      "val_ppl": 2.686629653178646,
      "val_acc": 0.8813504615583242,
      "val_f1": 0.7148678751142006,
      "lr": 0.06469129278753018
    },
    {
      "epoch": 21,
      "train_ppl": 2.1551849763500894,
      "train_acc": 0.9689715767354412,
      "train_f1": 0.0,
      "val_ppl": 2.6403577971898406,
      "val_acc": 0.8852882318765735,
      "val_f1": 0.7148870950032961,
      "lr": 0.061206888296141945
    },
    {
      "epoch": 22,
      "train_ppl": 2.127962845763476,
      "train_acc": 0.971748774223675,
      "train_f1": 0.0,
      "val_ppl": 2.661783295082683,
      "val_acc": 0.884449034923504,
      "val_f1": 0.7163882954517555,
      "lr": 0.0570152354472129
    },
    {
      "epoch": 23,
      "train_ppl": 2.1065193565097577,
      "train_acc": 0.9744030868672967,
      "train_f1": 0.0,
      "val_ppl": 2.660429321621822,
      "val_acc": 0.8847718029823769,
      "val_f1": 0.7179395726795561,
      "lr": 0.05224689108121028
    },
    {
      "epoch": 24,
      "train_ppl": 2.089580963728367,
      "train_acc": 0.9767624758838492,
      "train_f1": 0.0,
      "val_ppl": 2.659802392383842,
      "val_acc": 0.8853527854883481,
      "val_f1": 0.7184943652079155,
      "lr": 0.04705037417074984
    },
    {
      "epoch": 25,
      "train_ppl": 2.0782576363450755,
      "train_acc": 0.9771311304176856,
      "train_f1": 0.0,
      "val_ppl": 2.6388034469649155,
      "val_acc": 0.8850945710412498,
      "val_f1": 0.718433320066116,
      "lr": 0.04158753992038117
    },
    {
      "epoch": 26,
      "train_ppl": 2.069475285505932,
      "train_acc": 0.9787409218821043,
      "train_f1": 0.0,
      "val_ppl": 2.6637130289510114,
      "val_acc": 0.8859983216060938,
      "val_f1": 0.7180315386509641,
      "lr": 0.03602853848457289
    },
    {
      "epoch": 27,
      "train_ppl": 2.0600516245499807,
      "train_acc": 0.9794782309497769,
      "train_f1": 0.0,
      "val_ppl": 2.6609523088815146,
      "val_acc": 0.8867729649473888,
      "val_f1": 0.719131345554895,
      "lr": 0.030546515324022534
    },
    {
      "epoch": 28,
      "train_ppl": 2.0512669681161424,
      "train_acc": 0.9809405606006611,
      "train_f1": 0.0,
      "val_ppl": 2.680733528670881,
      "val_acc": 0.8857401071589955,
      "val_f1": 0.7187022201386061,
      "lr": 0.025312218267571025
    },
    {
      "epoch": 29,
      "train_ppl": 2.0461978483510275,
      "train_acc": 0.9812723496811139,
      "train_f1": 0.0,
      "val_ppl": 2.6824380484194648,
      "val_acc": 0.8854818927118973,
      "val_f1": 0.7239113609674973,
      "lr": 0.020488679252830218
    },
    {
      "epoch": 30,
      "train_ppl": 2.042984802462181,
      "train_acc": 0.9812723496811139,
      "train_f1": 0.0,
      "val_ppl": 2.687456798777353,
      "val_acc": 0.8858692143825447,
      "val_f1": 0.7453587977721104,
      "lr": 0.016226136392623755
    }
  ],
  "hyperparameters": {
    "architecture": {
      "emb_dim": 48,
      "dw_kernel": 3,
      "n_tags": 18,
      "max_len": 64,
      "hash_embed": false,
      "hash_dim": null,
      "num_buckets": null,
      "ngram_min": null,
      "ngram_max": null
    },
    "training": {
      "lr_max": 0.07,
      "lr_min": 0.0001,
      "epochs": 100,
      "warmup_epochs": 3,
      "label_smoothing": 0.1,
      "batch_size": 512,
      "scheduler": "SGDR"
    },
    "optimization": {
      "mixed_precision": true,
      "optimizer": "AdamW",
      "weight_decay": 0.0001,
      "compute_node_optimizations": false
    }
  },
  "environment": {
    "pytorch_version": "2.7.1+cu126",
    "cuda_available": true,
    "gpu_count": 4
  }
}